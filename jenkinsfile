pipeline {

    agent any
    tools {


    stages {
        nodejs "NODEJS" // Remplacez "NODEJS" par le nom de l'outil Node.js configur√© dans Jenkins
           

     }


     stage('Clone') {
    }

            steps {

                script {

                    git branch: 'main', credentialsId: 'ssh', url: 'https://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@github.com/nidhal19615/nodejs.git'

                }

            }

        }

        

       stage('Build and Push Docker Image') {

            steps {

                withCredentials([usernamePassword(credentialsId: 'dockerhub_id', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_PASSWORD')]) {

                    script {

                        sh 'docker build -t nidhal2/image-node .'

                        sh 'docker login -u $DOCKERHUB_USERNAME -p $DOCKERHUB_PASSWORD'

                        sh 'docker push nidhal2/image-node' 


                    }

                }

            }

        }

}
